<?php
// -------------------------entetes de pages------------------------
function connectSQL(){
	$db=@mysql_connect($GLOBALS['params']['bdd']['db_host'],$GLOBALS['params']['bdd']['db_user'],$GLOBALS['params']['bdd']['db_pass']);
	@mysql_select_db($GLOBALS['params']['bdd']['db_name'],$db);	
	mysql_query("SET NAMES 'utf8'");
	return $db;
}
function entete_page($title,$path) {
	if (!empty($path)){$addS="/";}else{$addS='';}
	echo ("<!DOCTYPE html public \"-//W3C//DTD XHTML 1.0 Transitional//EN\"
   \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">
	<html xmlns=\"http://www.w3.org/1999/xhtml\">
	<head>
	<script type=\"text/javascript\"></script>	
	<META http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">
	<META http-equiv=\"Cache-Control\" content=\"no-cache\">
	<META name=\"Author\" content=\"Guillaume VERNET\">	        
	<LINK rel=\"stylesheet\" type=\"text/css\" href=\"".$path.$addS."content/connexion.css\">\n
	<link rel=\"Stylesheet\" type=\"text/css\" href=\"".$path.$addS."content/jquery-ui/css/start/jquery-ui-1.8.6.custom.css\" />
	<title>$title</title>	
	");
}
function Cryptage($MDP, $Clef){
	$LClef = strlen($Clef);
	$LMDP = strlen($MDP);
	if ($LClef < $LMDP){
		$Clef = str_pad($Clef, $LMDP, $Clef, STR_PAD_RIGHT);
	}
	elseif ($LClef > $LMDP){
		$diff = $LClef - $LMDP;
		$_Clef = substr($Clef, 0, -$diff);
	}		
	return $MDP ^ $Clef; // La fonction envoie le texte crypté
		
}
//Nettoyage des variables
/*function clean_var($var,$check){		
	if ($check=='s' || empty($check)){
		$var=filter_var($var, FILTER_SANITIZE_STRING);//nettoyage des var de type string	
	}
	if ($check=='i'){
		$var=filter_var($var, FILTER_VALIDATE_INT);//nettoyage des var de type int
	}
	if ($check=='f'){
		$var=filter_var($var, FILTER_VALIDATE_FLOAT);//nettoyage des var de type float
	}
	if (@mysql_ping()){
		if(ctype_digit($var)){
			$var = intval($var);
		}else{			// Pour tous les autres types
			if (function_exists('get_magic_quotes_gpc') && get_magic_quotes_gpc()){
				$var = stripslashes($var);
			}				
			$var = mysql_real_escape_string($var);				
			$var = addcslashes($var, '%');
		}		
	}
	return $var;
}*/
function clean_var($var,$check){
	global $key,$source;   
	if ($check=='s' || empty($check)){		
		$var=filter_var($var, FILTER_SANITIZE_STRING);//nettoyage des var de type string
	}
	if ($check=='i'){		
		$var=filter_var($var, FILTER_VALIDATE_INT);//nettoyage des var de type int
	}
	if ($check=='f'){		
		$var=filter_var($var, FILTER_VALIDATE_FLOAT);//nettoyage des var de type float
	}
	if ($check=='sql'){	
		if(ctype_digit($var)){
			$var = intval($var);	
		}else{                  // Pour tous les autres types
			if (function_exists('get_magic_quotes_gpc') && get_magic_quotes_gpc()){
				
				$var = stripslashes($var);
			}
			$var = @mysql_real_escape_string($var);
			$var = addcslashes($var, '%');			
		}
	}
	return $var;
}
?>